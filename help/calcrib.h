      real*8 tk2,q2,p2,u2,z2,tk1,q1,rdcp,GRAV
      real*8 thta1,thta2,thta1v,thta2v,ribtmp,calcrib
