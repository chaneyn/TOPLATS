      integer natb,npix,nlcs,ipix,landc,int
      integer s_irntyp(MAX_ATB,MAX_VST,MAX_PP1)
      integer s_ievcon(MAX_ATB,MAX_VST,MAX_PP1)
      integer s_nr_irntyp(MAX_TOP,MAX_LAN,MAX_PP2)
      integer s_nr_ievcon(MAX_TOP,MAX_LAN,MAX_PP2)
      integer irntyp(MAX_PIX)
      integer ievcon(MAX_PIX)
      integer i,ivgtyp(MAX_VEG)
      integer FRCOV,veg(MAX_PP1,MAX_VST)
      integer m_lc,m_px,s_px,s_lc,sw_px,sw_lc

      real*8 FRC(MAX_PP2,MAX_TST),FRC_VALUE
      real*8 s_rnact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_xleact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_hact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_gact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tkact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_xinact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_runtot(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_zw(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_rzsm(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_rzsm1(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tzsm1(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_rnpet(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_xlepet(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_hpet(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_gpet(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tkpet(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_wcip1(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_Swq(MAX_ATB,1+SNOW_RUN*(MAX_VST-1),1+SNOW_RUN*(MAX_PP1-1))
      real*8 s_Swq_us(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_r_mossm(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))

      real*8 s_nr_rnact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_xleact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_hact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_gact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tkact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_xinact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_runtot(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_zw(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_rzsm(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_rzsm1(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tzsm1(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_rnpet(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_xlepet(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_hpet(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_gpet(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tkpet(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_wcip1(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_Swq(MAX_TOP,1+SNOW_RUN*(MAX_LAN-1),1+SNOW_RUN*(MAX_PP2-1))
      real*8 s_nr_Swq_us(MAX_TOP,1+SNW_FLG*(MAX_LAN-1),1+SNW_FLG*(MAX_PP2-1))
      real*8 s_nr_r_mossm(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))

      real*8 rnact(MAX_PIX)
      real*8 xleact(MAX_PIX)
      real*8 hact(MAX_PIX)
      real*8 gact(MAX_PIX)
      real*8 tkact(MAX_PIX)
      real*8 xinact(MAX_PIX)
      real*8 runtot(MAX_PIX)
      real*8 zw(MAX_PIX)
      real*8 rzsm(MAX_PIX)
      real*8 rzsm1(MAX_PIX)
      real*8 tzsm1(MAX_PIX)
      real*8 rnpet(MAX_PIX)
      real*8 xlepet(MAX_PIX)
      real*8 hpet(MAX_PIX)
      real*8 gpet(MAX_PIX)
      real*8 tkpet(MAX_PIX)
      real*8 wcip1(MAX_PIX)
      real*8 Swq(1+SNOW_RUN*(MAX_PIX-1))
      real*8 Swq_us(1+SNW_FLG*(MAX_PIX-1))
      real*8 r_mossm(1+MOS_FLG*(MAX_PIX-1))

      real*8 atb_pdf(MAX_PP1,MAX_ATB),veg_pdf(MAX_PP1,MAX_VST)

      real*8 t1(MAX_PIX),t2(MAX_PIX),sum(MAX_PIX)
