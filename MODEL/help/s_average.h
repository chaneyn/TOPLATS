      integer ipix,int,landc,i,jj,numnod,ic,m_lc,m_px,u_lc,u_px
      integer s_lc,s_px,sw_lc,sw_px,l_lc,l_px,numnodmax

      real*8 FRC,f1,f2

      integer s_nr_istmst(MAX_TOP,MAX_LAN,MAX_PP2)
      integer s_nr_intstm(MAX_TOP,MAX_LAN,MAX_PP2)
      integer s_nr_istmst_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      integer s_nr_intstm_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      integer s_nr_intstp(MAX_TOP,MAX_LAN,MAX_PP2)
      integer s_nr_istorm(MAX_TOP,MAX_LAN,MAX_PP2)
      integer s_nr_intstp_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      integer s_nr_istorm_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))

      real*8 s_nr_xintst_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_xintst(MAX_TOP,MAX_LAN,MAX_PP2)

      real*8 s_nr_PackWater(MAX_TOP,1+SNOW_RUN*(MAX_LAN-1),1+SNOW_RUN*(MAX_PP2-1))
      real*8 s_nr_SurfWater(MAX_TOP,1+SNOW_RUN*(MAX_LAN-1),1+SNOW_RUN*(MAX_PP2-1))
      real*8 s_nr_Swq(MAX_TOP,1+SNOW_RUN*(MAX_LAN-1),1+SNOW_RUN*(MAX_PP2-1))
      real*8 s_nr_VaporMassFlux(MAX_TOP,1+SNOW_RUN*(MAX_LAN-1),1+SNOW_RUN*(MAX_PP2-1))
      real*8 s_nr_TPack(MAX_TOP,1+SNOW_RUN*(MAX_LAN-1),1+SNOW_RUN*(MAX_PP2-1))
      real*8 s_nr_TSurf(MAX_TOP,1+SNOW_RUN*(MAX_LAN-1),1+SNOW_RUN*(MAX_PP2-1))
      real*8 s_nr_r_MeltEnergy(MAX_TOP,1+SNOW_RUN*(MAX_LAN-1),1+SNOW_RUN*(MAX_PP2-1))
      real*8 s_nr_Outflow(MAX_TOP,1+SNOW_RUN*(MAX_LAN-1),1+SNOW_RUN*(MAX_PP2-1))
      real*8 s_nr_xleact_snow(MAX_TOP,1+SNOW_RUN*(MAX_LAN-1),1+SNOW_RUN*(MAX_PP2-1))
      real*8 s_nr_hact_snow(MAX_TOP,1+SNOW_RUN*(MAX_LAN-1),1+SNOW_RUN*(MAX_PP2-1))
      real*8 s_nr_rn_snow(MAX_TOP,1+SNOW_RUN*(MAX_LAN-1),1+SNOW_RUN*(MAX_PP2-1))
      real*8 s_nr_PackWater_us(MAX_TOP,1+SNW_FLG*(MAX_LAN-1),1+SNW_FLG*(MAX_PP2-1))
      real*8 s_nr_SurfWater_us(MAX_TOP,1+SNW_FLG*(MAX_LAN-1),1+SNW_FLG*(MAX_PP2-1))
      real*8 s_nr_Swq_us(MAX_TOP,1+SNW_FLG*(MAX_LAN-1),1+SNW_FLG*(MAX_PP2-1))
      real*8 s_nr_VaporMassFlux_us(MAX_TOP,1+SNW_FLG*(MAX_LAN-1),1+SNW_FLG*(MAX_PP2-1))
      real*8 s_nr_TPack_us(MAX_TOP,1+SNW_FLG*(MAX_LAN-1),1+SNW_FLG*(MAX_PP2-1))
      real*8 s_nr_TSurf_us(MAX_TOP,1+SNW_FLG*(MAX_LAN-1),1+SNW_FLG*(MAX_PP2-1))
      real*8 s_nr_r_MeltEnergy_us(MAX_TOP,1+SNW_FLG*(MAX_LAN-1),1+SNW_FLG*(MAX_PP2-1))
      real*8 s_nr_Outflow_us(MAX_TOP,1+SNW_FLG*(MAX_LAN-1),1+SNW_FLG*(MAX_PP2-1))
      real*8 s_nr_xleact_snow_us(MAX_TOP,1+SNW_FLG*(MAX_LAN-1),1+SNW_FLG*(MAX_PP2-1))
      real*8 s_nr_hact_snow_us(MAX_TOP,1+SNW_FLG*(MAX_LAN-1),1+SNW_FLG*(MAX_PP2-1))
      real*8 s_nr_rn_snow_us(MAX_TOP,1+SNW_FLG*(MAX_LAN-1),1+SNW_FLG*(MAX_PP2-1))
      real*8 s_nr_alb_snow(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_dens(MAX_TOP,1+SNOW_RUN*(MAX_LAN-1),1+SNOW_RUN*(MAX_PP2-1))
      real*8 s_nr_dens_us(MAX_TOP,1+SNW_FLG*(MAX_LAN-1),1+SNW_FLG*(MAX_PP2-1))

      real*8 s_nr_sesq(MAX_TOP,MAX_LAN,MAX_PP2)

      real*8 s_nr_cuminf(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_sorp(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_cc(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_xinact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_runtot(MAX_TOP,MAX_LAN,MAX_PP2)

      real*8 s_nr_rnact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_xleact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_hact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_gact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tkact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tkmid(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_dshact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tkact_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_tkmid_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_dshact_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_rnact_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_xleact_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_hact_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_gact_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_tkact_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_tkmid_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_dshact_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_rnact_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_xleact_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_hact_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_gact_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_tskinact_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_evtact(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_evtact_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_evtact_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))

      real*8 s_nr_rnpet(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_xlepet(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_hpet(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_gpet(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tkpet(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tkmidpet(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_dspet(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_rnpet_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_xlepet_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_hpet_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_gpet_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_tkpet_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_tkmidpet_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_dspet_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_rnpet_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_xlepet_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_hpet_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_gpet_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_tkpet_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_tkmidpet_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_tskinpet_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_dspet_moss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))

      real*8 s_nr_ebspot(MAX_TOP,MAX_LAN,MAX_PP2)

      real*8 s_nr_wcip1(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_wsc(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_wcip1_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))
      real*8 s_nr_wsc_us(MAX_TOP,1+UST_FLG*(MAX_LAN-1),1+UST_FLG*(MAX_PP2-1))

      real*8 s_nr_rzsm(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_rzsm1(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_rzsm_u(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_rzsm1_u(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_rzsm_f(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_rzsm1_f(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_rzdthetaidt(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_rzdthetaudtemp(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tzdthetaidt(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_zmoss(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_r_mossm(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_r_mossm1(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_r_mossm_u(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_r_mossm1_u(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_r_mossm_f(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_r_mossm1_f(MAX_TOP,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP2-1))
      real*8 s_nr_tzsm(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tzsm1(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tzsm_u(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tzsm1_u(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tzsm_f(MAX_TOP,MAX_LAN,MAX_PP2)
      real*8 s_nr_tzsm1_f(MAX_TOP,MAX_LAN,MAX_PP2)

      real*8 s_nr_zw(MAX_TOP,MAX_LAN,MAX_PP2)

      real*8 s_nr_preca_a(MAX_TOP,1+LAK_FLG*(MAX_LAN-1),1+LAK_FLG*(MAX_PP2-1))
      real*8 s_nr_tp_in(MAX_TOP,1+LAK_FLG*(MAX_LAN-1),1+LAK_FLG*(MAX_PP2-1))
      real*8 s_nr_hice_in(MAX_TOP,1+LAK_FLG*(MAX_LAN-1),1+LAK_FLG*(MAX_PP2-1))
      real*8 s_nr_hsnw_in(MAX_TOP,1+LAK_FLG*(MAX_LAN-1),1+LAK_FLG*(MAX_PP2-1))
      real*8 s_nr_temp_a(MAX_TOP,1+LAK_FLG*(MAX_LAN-1),1+LAK_FLG*(MAX_PP2-1),1+LAK_FLG*(MAX_NOD-1))
      real*8 s_nr_tempi_a(MAX_TOP,1+LAK_FLG*(MAX_LAN-1),1+LAK_FLG*(MAX_PP2-1))
      real*8 s_nr_hice_a(MAX_TOP,1+LAK_FLG*(MAX_LAN-1),1+LAK_FLG*(MAX_PP2-1))
      real*8 s_nr_hsnow_a(MAX_TOP,1+LAK_FLG*(MAX_LAN-1),1+LAK_FLG*(MAX_PP2-1))

      integer s_nr_mixmax(MAX_TOP,1+LAK_FLG*(MAX_LAN-1),1+LAK_FLG*(MAX_PP2-1))

      real*8 s_nr_fraci_a(MAX_TOP,1+LAK_FLG*(MAX_LAN-1),1+LAK_FLG*(MAX_PP2-1))
      real*8 s_nr_precacc(MAX_TOP,1+LAK_FLG*(MAX_LAN-1),1+LAK_FLG*(MAX_PP2-1))

      real*8 zbar(MAX_CAT)
      real*8 zbar1(MAX_CAT)

      integer s_istmst(MAX_ATB,MAX_VST,MAX_PP1)
      integer s_intstm(MAX_ATB,MAX_VST,MAX_PP1)
      integer s_istmst_moss(MAX_ATB,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP1-1))
      integer s_intstm_moss(MAX_ATB,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP1-1))
      integer s_intstp(MAX_ATB,MAX_VST,MAX_PP1)
      integer s_istorm(MAX_ATB,MAX_VST,MAX_PP1)
      integer s_intstp_moss(MAX_ATB,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP1-1))
      integer s_istorm_moss(MAX_ATB,1+MOS_FLG*(MAX_LAN-1),1+MOS_FLG*(MAX_PP1-1))

      real*8 s_xintst_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_xintst(MAX_ATB,MAX_VST,MAX_PP1)

      real*8 s_PackWater(MAX_ATB,1+SNOW_RUN*(MAX_VST-1),1+SNOW_RUN*(MAX_PP1-1))
      real*8 s_SurfWater(MAX_ATB,1+SNOW_RUN*(MAX_VST-1),1+SNOW_RUN*(MAX_PP1-1))
      real*8 s_Swq(MAX_ATB,1+SNOW_RUN*(MAX_VST-1),1+SNOW_RUN*(MAX_PP1-1))
      real*8 s_VaporMassFlux(MAX_ATB,1+SNOW_RUN*(MAX_VST-1),1+SNOW_RUN*(MAX_PP1-1))
      real*8 s_TPack(MAX_ATB,1+SNOW_RUN*(MAX_VST-1),1+SNOW_RUN*(MAX_PP1-1))
      real*8 s_TSurf(MAX_ATB,1+SNOW_RUN*(MAX_VST-1),1+SNOW_RUN*(MAX_PP1-1))
      real*8 s_r_MeltEnergy(MAX_ATB,1+SNOW_RUN*(MAX_VST-1),1+SNOW_RUN*(MAX_PP1-1))
      real*8 s_Outflow(MAX_ATB,1+SNOW_RUN*(MAX_VST-1),1+SNOW_RUN*(MAX_PP1-1))
      real*8 s_xleact_snow(MAX_ATB,1+SNOW_RUN*(MAX_VST-1),1+SNOW_RUN*(MAX_PP1-1))
      real*8 s_hact_snow(MAX_ATB,1+SNOW_RUN*(MAX_VST-1),1+SNOW_RUN*(MAX_PP1-1))
      real*8 s_rn_snow(MAX_ATB,1+SNOW_RUN*(MAX_VST-1),1+SNOW_RUN*(MAX_PP1-1))
      real*8 s_PackWater_us(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_SurfWater_us(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_Swq_us(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_VaporMassFlux_us(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_TPack_us(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_TSurf_us(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_r_MeltEnergy_us(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_Outflow_us(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_xleact_snow_us(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_hact_snow_us(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_rn_snow_us(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_alb_snow(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_dens(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_dens_us(MAX_ATB,1+SNW_FLG*(MAX_VST-1),1+SNW_FLG*(MAX_PP1-1))
      real*8 s_sesq(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_cuminf(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_sorp(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_cc(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_xinact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_runtot(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_rnact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_xleact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_hact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_gact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tkact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tkmid(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_dshact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tkact_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_tkmid_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_dshact_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_rnact_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_xleact_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_hact_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_gact_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_tkact_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_tkmid_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_dshact_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_rnact_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_xleact_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_hact_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_gact_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_tskinact_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_evtact(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_evtact_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_evtact_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))

      real*8 s_rnpet(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_xlepet(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_hpet(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_gpet(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tkpet(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tkmidpet(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_dspet(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_rnpet_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_xlepet_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_hpet_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_gpet_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_tkpet_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_tkmidpet_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_dspet_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_rnpet_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_xlepet_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_hpet_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_gpet_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_tkpet_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_tkmidpet_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_tskinpet_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_dspet_moss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))

      real*8 s_ebspot(MAX_ATB,MAX_VST,MAX_PP1)

      real*8 s_wcip1(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_wsc(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_wcip1_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))
      real*8 s_wsc_us(MAX_ATB,1+UST_FLG*(MAX_VST-1),1+UST_FLG*(MAX_PP1-1))

      real*8 s_rzsm(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_rzsm1(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_rzsm_u(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_rzsm1_u(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_rzsm_f(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_rzsm1_f(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_rzdthetaidt(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_rzdthetaudtemp(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tzdthetaidt(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_zmoss(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_r_mossm(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_r_mossm1(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_r_mossm_u(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_r_mossm1_u(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_r_mossm_f(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_r_mossm1_f(MAX_ATB,1+MOS_FLG*(MAX_VST-1),1+MOS_FLG*(MAX_PP1-1))
      real*8 s_tzsm(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tzsm1(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tzsm_u(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tzsm1_u(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tzsm_f(MAX_ATB,MAX_VST,MAX_PP1)
      real*8 s_tzsm1_f(MAX_ATB,MAX_VST,MAX_PP1)

      real*8 s_zw(MAX_ATB,MAX_VST,MAX_PP1)

      real*8 s_preca_a(MAX_ATB,1+LAK_FLG*(MAX_VST-1),1+LAK_FLG*(MAX_PP1-1))
      real*8 s_tp_in(MAX_ATB,1+LAK_FLG*(MAX_VST-1),1+LAK_FLG*(MAX_PP1-1))
      real*8 s_hice_in(MAX_ATB,1+LAK_FLG*(MAX_VST-1),1+LAK_FLG*(MAX_PP1-1))
      real*8 s_hsnw_in(MAX_ATB,1+LAK_FLG*(MAX_VST-1),1+LAK_FLG*(MAX_PP1-1))
      real*8 s_temp_a(MAX_ATB,1+LAK_FLG*(MAX_VST-1),1+LAK_FLG*(MAX_PP1-1),1+LAK_FLG*(MAX_NOD-1))
      real*8 s_tempi_a(MAX_ATB,1+LAK_FLG*(MAX_VST-1),1+LAK_FLG*(MAX_PP1-1))
      real*8 s_hice_a(MAX_ATB,1+LAK_FLG*(MAX_VST-1),1+LAK_FLG*(MAX_PP1-1))
      real*8 s_hsnow_a(MAX_ATB,1+LAK_FLG*(MAX_VST-1),1+LAK_FLG*(MAX_PP1-1))

      integer s_mixmax(MAX_ATB,1+LAK_FLG*(MAX_VST-1),1+LAK_FLG*(MAX_PP1-1))

      real*8 s_fraci_a(MAX_ATB,1+LAK_FLG*(MAX_VST-1),1+LAK_FLG*(MAX_PP1-1))
      real*8 s_precacc(MAX_ATB,1+LAK_FLG*(MAX_VST-1),1+LAK_FLG*(MAX_PP1-1))

      real*8 s_nr_zbar(MAX_CAT)
      real*8 s_nr_zbar1(MAX_CAT)
