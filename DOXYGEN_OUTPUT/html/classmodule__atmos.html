<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3"/>
<title>TOPLATS: module_atmos Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TOPLATS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="modulemodule__atmos-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">module_atmos Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9ac7d8cfa7a9cb7111c7bff5633ff009"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__atmos.html#a9ac7d8cfa7a9cb7111c7bff5633ff009">atmos</a> (ipix, i, GRID_VEG, CELL_VARS, GRID_MET, GRID_VARS, GRID_SOIL, GLOBAL)</td></tr>
<tr class="separator:a9ac7d8cfa7a9cb7111c7bff5633ff009"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2a76462207d01141c5eda614aa2fbea"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__atmos.html#ac2a76462207d01141c5eda614aa2fbea">inittk</a> (GRID_SOIL, GRID_VEG, GRID_VARS, tdeep, tmid0, tmid0_moss, tkmid, tkmid_us, tkmid_moss, tkel, tk0moss, tkact, tkact_us, tkact_moss, tskinact_moss, dshact, dshact_us, dshact_moss, tkpet, tkmidpet, tkmidpet_us, tkmidpet_moss, dspet, dspet_us, dspet_moss, Tsurf, Tpack, Tsurf_us, Tpack_us)</td></tr>
<tr class="memdesc:ac2a76462207d01141c5eda614aa2fbea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to assign initial soil temperatures and set heat storage variables for the first time step in the simulation.  <a href="#ac2a76462207d01141c5eda614aa2fbea"></a><br/></td></tr>
<tr class="separator:ac2a76462207d01141c5eda614aa2fbea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37a213735f0eb4c1e3b7a6e495f8f84b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__atmos.html#a37a213735f0eb4c1e3b7a6e495f8f84b">petpen</a> (GRID_VEG, GRID_MET, GRID_VARS, tcel, vpsat, vpdef, f1par, albd, xlai, rsd, rsmin, rsmax, Rpl, tkel, vppa, f3vpd, f3vpdpar, f4temp, trefk, f4temppar, rnetpn, gbspen, rnetd, rnetw, gd, gw, rescan, ravd, xlhv, row, epetd, epetw, ravw, psychr, xled, xlew, hd, hw, cp, roa)</td></tr>
<tr class="memdesc:a37a213735f0eb4c1e3b7a6e495f8f84b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the potential evapotranspiration using penman's equation for bare soil and penman-monteith for vegetated areas.  <a href="#a37a213735f0eb4c1e3b7a6e495f8f84b"></a><br/></td></tr>
<tr class="separator:a37a213735f0eb4c1e3b7a6e495f8f84b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b61eacddb768855ab7cc5e532a4a3cd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__atmos.html#a5b61eacddb768855ab7cc5e532a4a3cd">peteb</a> (ipix, i, dt, inc_frozen,</td></tr>
<tr class="memdesc:a5b61eacddb768855ab7cc5e532a4a3cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to calculate the potential evapotranspiration using the combination method (i.e. solving the set of nonlinear energy balance equations iteratively). three energy balances are maintained: one for bare soil, one for wet vegetation and one for dry vegetation.  <a href="#a5b61eacddb768855ab7cc5e532a4a3cd"></a><br/></td></tr>
<tr class="separator:a5b61eacddb768855ab7cc5e532a4a3cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0c98f0d3f8ccaee29fa3742461f8ffc"><td class="memItemLeft" align="right" valign="top">real *8 function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__atmos.html#af0c98f0d3f8ccaee29fa3742461f8ffc">esat</a> (Tsk)</td></tr>
<tr class="memdesc:af0c98f0d3f8ccaee29fa3742461f8ffc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute saturation vapor pressure in Pa. given temperature in Kelvin.  <a href="#af0c98f0d3f8ccaee29fa3742461f8ffc"></a><br/></td></tr>
<tr class="separator:af0c98f0d3f8ccaee29fa3742461f8ffc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ccd83fc7c711ad05ee1ee05f77fa0c8"><td class="memItemLeft" align="right" valign="top">real *8 function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__atmos.html#a0ccd83fc7c711ad05ee1ee05f77fa0c8">clcf1par</a> (alb, LAI, Rg, rsmin, rsmax, Rgl)</td></tr>
<tr class="memdesc:a0ccd83fc7c711ad05ee1ee05f77fa0c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the limiting factor due to Photosynthetically Active Radiation (PAR) for canopy resistance following Jarvis (1976), Dickenson et al. (1986), Noilhan and Planton (1989)  <a href="#a0ccd83fc7c711ad05ee1ee05f77fa0c8"></a><br/></td></tr>
<tr class="separator:a0ccd83fc7c711ad05ee1ee05f77fa0c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bdd723bb1b1abc4d9177409c216d3ad"><td class="memItemLeft" align="right" valign="top">real *8 function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__atmos.html#a3bdd723bb1b1abc4d9177409c216d3ad">clcf3vpd</a> (Ts, ea, g)</td></tr>
<tr class="memdesc:a3bdd723bb1b1abc4d9177409c216d3ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the limiting factor due to vapor pressure for canopy resistance following Jarvis (1976), Dickenson et al. (1986), Noilhan and Planton (1989)  <a href="#a3bdd723bb1b1abc4d9177409c216d3ad"></a><br/></td></tr>
<tr class="separator:a3bdd723bb1b1abc4d9177409c216d3ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46811b0c944e97060dbc57b0ee132e06"><td class="memItemLeft" align="right" valign="top">real *8 function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__atmos.html#a46811b0c944e97060dbc57b0ee132e06">clcf4temp</a> (tair, tref, f4par)</td></tr>
<tr class="memdesc:a46811b0c944e97060dbc57b0ee132e06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the limiting factor due to air temperature for canopy resistance following Jarvis (1976), Dickenson et al. (1986), Noilhan and Planton (1989)  <a href="#a46811b0c944e97060dbc57b0ee132e06"></a><br/></td></tr>
<tr class="separator:a46811b0c944e97060dbc57b0ee132e06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a256a2fff00e163f0ae8dcdcc8761592c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__atmos.html#a256a2fff00e163f0ae8dcdcc8761592c">peteb_bs</a> (thermc1, thermc2, heatcap1, heatcap2, heatcapold, rain, snow, Swq, albd, emiss, ravd, rahd, tkd, tkmidd, rnetd, xled, epetd, hd, gd, dshd, tcel, vppa, roa, psychr, xlhv, zdeep, Tdeepstep, zmid, rsd, rld, toleb, maxnri, dt, i, tkw, tkmidw, rnetw, xlew, epetw, hw, gw, dshw, ravw, rahw, PackWater, SurfWater, VaporMassFlux, TPack, TSurf, r_MeltEnergy, Outflow, xleact_snow, hact_snow, rn_snow, dens, za, zpd, albw, z0h, RaSnow, alb_snow, appa, vpsat, uzw, gact, row)</td></tr>
<tr class="memdesc:a256a2fff00e163f0ae8dcdcc8761592c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the energy balance at potential rate for bare soil.  <a href="#a256a2fff00e163f0ae8dcdcc8761592c"></a><br/></td></tr>
<tr class="separator:a256a2fff00e163f0ae8dcdcc8761592c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad27d1fb1ddac9bbb1ea4699a18eba7df"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__atmos.html#ad27d1fb1ddac9bbb1ea4699a18eba7df">peteb_dv</a> (thermc2, vpsat, heatcap, heatcap2, heatcapold, rs_over, rain, snow, Swq, albd, emiss, thermc, f1par, f3vpd, f4temp, rescan, ravd, rahd, tkd, tkmidd, rnetd, xled, epetd, hd, gd, dshd, tcel, vppa, roa, psychr, xlhv, zdeep, Tdeepstep, zmid, rld, toleb, maxnri, dt, i, PackWater, SurfWater, VaporMassFlux, TPack, TSurf, r_MeltEnergy, Outflow, xleact_snow, hact_snow, rn_snow, dens, za, zpd, z0h, RaSnow, appa, uzw, gact, alb_snow, row)</td></tr>
<tr class="memdesc:ad27d1fb1ddac9bbb1ea4699a18eba7df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the energy balance at potential rate for dry vegetation, over story.  <a href="#ad27d1fb1ddac9bbb1ea4699a18eba7df"></a><br/></td></tr>
<tr class="separator:ad27d1fb1ddac9bbb1ea4699a18eba7df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1d70ea42fba682b775505cb9d8ffcde"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__atmos.html#ab1d70ea42fba682b775505cb9d8ffcde">peteb_wv</a> (thermc2, heatcap, heatcap2, heatcapold, rs_over, rain, snow, Swq, albw, emiss, thermc, ravw, rahw, tkw, tkmidw, rnetw, xlew, epetw, hw, gw, dshw, tcel, vppa, roa, psychr, xlhv, zdeep, Tdeepstep, zmid, rld, toleb, maxnri, dt, i, iopstab, tkact, zww, za, uzw, zpd, z0m, tkel, press, rib, z0h, PackWater, SurfWater, VaporMassFlux, TPack, TSurf, r_MeltEnergy, Outflow, xleact_snow, hact_snow, rn_snow, dens, RaSnow, alb_snow, appa, vpsat, gact, row, ipix)</td></tr>
<tr class="memdesc:ab1d70ea42fba682b775505cb9d8ffcde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the energy balance at potential rate for wet vegetation, over story.  <a href="#ab1d70ea42fba682b775505cb9d8ffcde"></a><br/></td></tr>
<tr class="separator:ab1d70ea42fba682b775505cb9d8ffcde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a006b822a8fc84cc2657a18e0bddaeac3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmodule__atmos.html#a006b822a8fc84cc2657a18e0bddaeac3">inidum</a> (dum1, PackWater, dum2, SurfWater, dum3, Swq, dum4, VaporMassFlux, dum5, TPack, dum6, TSurf, dum7, r_MeltEnergy, dum8, Outflow, dum9, xleact_snow, dum10, hact_snow, dum11, rn_snow, dum12, dens)</td></tr>
<tr class="memdesc:a006b822a8fc84cc2657a18e0bddaeac3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the snow model variables that will be used in the snow subroutine but that not will be altered in the main program.  <a href="#a006b822a8fc84cc2657a18e0bddaeac3"></a><br/></td></tr>
<tr class="separator:a006b822a8fc84cc2657a18e0bddaeac3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="MODULE__ATMOS_8f90_source.html#l00001">1</a> of file <a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a>.</p>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a class="anchor" id="a9ac7d8cfa7a9cb7111c7bff5633ff009"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_atmos::atmos </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ipix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (grid_veg_template)&#160;</td>
          <td class="paramname"><em>GRID_VEG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (cell_vars_template)&#160;</td>
          <td class="paramname"><em>CELL_VARS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (grid_met_template)&#160;</td>
          <td class="paramname"><em>GRID_MET</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (grid_vars_template)&#160;</td>
          <td class="paramname"><em>GRID_VARS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (grid_soil_template)&#160;</td>
          <td class="paramname"><em>GRID_SOIL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (global_template)&#160;</td>
          <td class="paramname"><em>GLOBAL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="MODULE__ATMOS_8f90_source.html#l00034">34</a> of file <a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a>.</p>

<p>References <a class="el" href="MODULE__SHARED_8f90_source.html#l01249">module_shared::calcra()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l00427">inittk()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l00729">peteb()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l00557">petpen()</a>, and <a class="el" href="MODULE__SHARED_8f90_source.html#l00440">module_shared::stabcor()</a>.</p>

<p>Referenced by <a class="el" href="MODULE__CELL_8f90_source.html#l00072">module_cell::update_cell()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_a9ac7d8cfa7a9cb7111c7bff5633ff009_cgraph.png" border="0" usemap="#classmodule__atmos_a9ac7d8cfa7a9cb7111c7bff5633ff009_cgraph" alt=""/></div>
<map name="classmodule__atmos_a9ac7d8cfa7a9cb7111c7bff5633ff009_cgraph" id="classmodule__atmos_a9ac7d8cfa7a9cb7111c7bff5633ff009_cgraph">
<area shape="rect" id="node3" href="classmodule__shared.html#a57fd8f76c675564f50596c4188b00485" title="module_shared::calcra" alt="" coords="709,5,875,32"/><area shape="rect" id="node5" href="classmodule__atmos.html#ac2a76462207d01141c5eda614aa2fbea" title="Subroutine to assign initial soil temperatures and set heat storage variables for the first time step..." alt="" coords="228,473,385,500"/><area shape="rect" id="node7" href="classmodule__atmos.html#a5b61eacddb768855ab7cc5e532a4a3cd" title="Subroutine to calculate the potential evapotranspiration using the combination method (i..." alt="" coords="225,321,388,348"/><area shape="rect" id="node59" href="classmodule__shared.html#a2a0724bfbc1d78552bf96b93956b08ca" title="Subroutine to calculate all variables related to stability correction and aerodynami! resistances..." alt="" coords="703,107,881,133"/><area shape="rect" id="node67" href="classmodule__atmos.html#a37a213735f0eb4c1e3b7a6e495f8f84b" title="Subroutine to calculate the potential evapotranspiration using penman&#39;s equation for bare soil and pe..." alt="" coords="221,423,392,449"/><area shape="rect" id="node9" href="classmodule__shared.html#a5853589e5ecabcd610401615791e1b1c" title="Calculate the incoming solar radiation for the under and over story under the assumption of only one ..." alt="" coords="455,448,628,475"/><area shape="rect" id="node11" href="classmodule__shared.html#ab1e0fcd7b943d6d47ec1467b04295c57" title="Initialize soil moisture for the calculation of the thermodynami parameters, as a centered difference..." alt="" coords="441,93,642,120"/><area shape="rect" id="node13" href="classmodule__shared.html#a3035d2077015b1668623b5e23b9f95a5" title="Calculate the soil thermal parameters." alt="" coords="447,397,636,424"/><area shape="rect" id="node21" href="classmodule__atmos.html#a256a2fff00e163f0ae8dcdcc8761592c" title="Solve the energy balance at potential rate for bare soil." alt="" coords="449,347,634,373"/><area shape="rect" id="node40" href="classmodule__shared.html#af41c791600df378bb52d6b76fe3bec4e" title="Adapt the thermal parameters for vegetated surfaces." alt="" coords="448,144,635,171"/><area shape="rect" id="node42" href="classmodule__atmos.html#a0ccd83fc7c711ad05ee1ee05f77fa0c8" title="Calculate the limiting factor due to Photosynthetically Active Radiation (PAR) for canopy resistance ..." alt="" coords="453,195,629,221"/><area shape="rect" id="node44" href="classmodule__atmos.html#a3bdd723bb1b1abc4d9177409c216d3ad" title="Calculate the limiting factor due to vapor pressure for canopy resistance following Jarvis (1976)..." alt="" coords="452,499,631,525"/><area shape="rect" id="node48" href="classmodule__atmos.html#a46811b0c944e97060dbc57b0ee132e06" title="Calculate the limiting factor due to air temperature for canopy resistance following Jarvis (1976)..." alt="" coords="447,549,636,576"/><area shape="rect" id="node50" href="classmodule__atmos.html#ad27d1fb1ddac9bbb1ea4699a18eba7df" title="Solve the energy balance at potential rate for dry vegetation, over story." alt="" coords="449,296,634,323"/><area shape="rect" id="node56" href="classmodule__atmos.html#ab1d70ea42fba682b775505cb9d8ffcde" title="Solve the energy balance at potential rate for wet vegetation, over story." alt="" coords="448,245,635,272"/><area shape="rect" id="node15" href="classmodule__shared.html#ab612ad0ea7a26f361a65d9f726ca5a0e" title="module_shared::calctc_m" alt="" coords="699,397,885,424"/><area shape="rect" id="node17" href="classmodule__shared.html#a9d7b9c5c70ac25f2cfbf280981ef6301" title="Calculate the thermal conductivity (thermc) of an unsaturated soil using Johansen&#39;s method..." alt="" coords="704,448,880,475"/><area shape="rect" id="node19" href="classmodule__shared.html#abeb649a221f7f2002b81d5ada56ee6bc" title="Calculate the heat capacity of the soil using the input soil moisture requested (theta), and saturated soil moisture or porosity (thetasat). Heat capacity found as density&#45;weighted combination of soil, water and air heat capacities." alt="" coords="707,499,877,525"/><area shape="rect" id="node23" href="classmodule__shared.html#af8d6172a7faee4205abe3a393491e55e" title="module_shared::nreb" alt="" coords="713,296,871,323"/><area shape="rect" id="node25" href="classmodule__atmos.html#a006b822a8fc84cc2657a18e0bddaeac3" title="Initialize the snow model variables that will be used in the snow subroutine but that not will be alt..." alt="" coords="707,347,877,373"/><area shape="rect" id="node27" href="classmodule__snow.html#a7384dfa1b5cc4f948970cd65bcea94c8" title="Calculate snow accumulation and melt using an energy balance approach for a two layer snow model..." alt="" coords="691,195,893,221"/><area shape="rect" id="node38" href="classmodule__shared.html#a46957caed7b9b6c216cb9d3d3da2d34a" title="module_shared::nreb_snow" alt="" coords="693,245,891,272"/><area shape="rect" id="node29" href="classmodule__snow.html#aba96f18deffc8a88948404c04b964aab" title="Calculate the surface energy balance for the snow pack." alt="" coords="1169,208,1442,235"/><area shape="rect" id="node35" href="classmodule__snow.html#a01052a35c199bd967c88f505f5a9ea0e" title="Calculate the surface temperature in the absence of snow." alt="" coords="942,183,1119,209"/><area shape="rect" id="node31" href="classmodule__snow.html#ab071adc15b6a3d9eeec011e963c7f024" title="Calculate atmospheri! stability correction for non&#45;neutral conditions." alt="" coords="1491,183,1722,209"/><area shape="rect" id="node33" href="classmodule__snow.html#a906b9ae113669804289e3ead4ea25112" title="Calculate the saturated vapor pressure in the snow pack." alt="" coords="1492,233,1721,260"/><area shape="rect" id="node46" href="classmodule__atmos.html#af0c98f0d3f8ccaee29fa3742461f8ffc" title="Compute saturation vapor pressure in Pa. given temperature in Kelvin." alt="" coords="715,549,869,576"/><area shape="rect" id="node61" href="classmodule__shared.html#a50955cdddd2ff32a49f43ac35f1f41a2" title="Calculate Bulk Richardson number based on input temperature, humidity, pressure, wind profile..." alt="" coords="945,107,1116,133"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_a9ac7d8cfa7a9cb7111c7bff5633ff009_icgraph.png" border="0" usemap="#classmodule__atmos_a9ac7d8cfa7a9cb7111c7bff5633ff009_icgraph" alt=""/></div>
<map name="classmodule__atmos_a9ac7d8cfa7a9cb7111c7bff5633ff009_icgraph" id="classmodule__atmos_a9ac7d8cfa7a9cb7111c7bff5633ff009_icgraph">
<area shape="rect" id="node3" href="classmodule__cell.html#a70b7ade0b81899a7b22cef286c3a608b" title="module_cell::update_cell" alt="" coords="221,12,400,39"/><area shape="rect" id="node5" href="classmodule__cell.html#ac9479702e38648052df3b94e47fd6e64" title="module_cell::update\l_cells" alt="" coords="449,5,599,46"/><area shape="rect" id="node7" href="TOPLATS__DRIVER_8f90.html#a1172731b68e0187d74326a81c0d80390" title="TOPLATS interface." alt="" coords="648,12,757,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0ccd83fc7c711ad05ee1ee05f77fa0c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real*8 function module_atmos::clcf1par </td>
          <td>(</td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>alb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Rg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rsmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rsmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Rgl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the limiting factor due to Photosynthetically Active Radiation (PAR) for canopy resistance following Jarvis (1976), Dickenson et al. (1986), Noilhan and Planton (1989) </p>

<p>Definition at line <a class="el" href="MODULE__ATMOS_8f90_source.html#l01359">1359</a> of file <a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a>.</p>

<p>Referenced by <a class="el" href="TESTS__DRIVER_8f90_source.html#l00015">module_unit_tests::clcf1par_test1()</a>, <a class="el" href="TESTS__DRIVER_8f90_source.html#l00024">module_unit_tests::clcf1par_test2()</a>, and <a class="el" href="MODULE__ATMOS_8f90_source.html#l00729">peteb()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_a0ccd83fc7c711ad05ee1ee05f77fa0c8_icgraph.png" border="0" usemap="#classmodule__atmos_a0ccd83fc7c711ad05ee1ee05f77fa0c8_icgraph" alt=""/></div>
<map name="classmodule__atmos_a0ccd83fc7c711ad05ee1ee05f77fa0c8_icgraph" id="classmodule__atmos_a0ccd83fc7c711ad05ee1ee05f77fa0c8_icgraph">
<area shape="rect" id="node3" href="classmodule__unit__tests.html#aab90ef123405f2a0ab168a7c471ef92a" title="module_unit_tests::\lclcf1par_test1" alt="" coords="237,5,385,46"/><area shape="rect" id="node9" href="classmodule__unit__tests.html#a4d12daa6bee935abec85578f898a5099" title="module_unit_tests::\lclcf1par_test2" alt="" coords="237,70,385,111"/><area shape="rect" id="node12" href="classmodule__atmos.html#a5b61eacddb768855ab7cc5e532a4a3cd" title="Subroutine to calculate the potential evapotranspiration using the combination method (i..." alt="" coords="229,136,392,163"/><area shape="rect" id="node5" href="classmodule__unit__tests.html#a3f4e9bd4cff4b73206b3c6a2d2414d7f" title="module_unit_tests::\lrun_unit_tests" alt="" coords="450,38,598,79"/><area shape="rect" id="node7" href="TESTS__DRIVER_8f90.html#aff76d0cacdf10182d98bc48b22593f1a" title="tests_driver" alt="" coords="697,45,794,72"/><area shape="rect" id="node14" href="classmodule__atmos.html#a9ac7d8cfa7a9cb7111c7bff5633ff009" title="module_atmos::atmos" alt="" coords="441,136,607,163"/><area shape="rect" id="node16" href="classmodule__cell.html#a70b7ade0b81899a7b22cef286c3a608b" title="module_cell::update_cell" alt="" coords="656,136,835,163"/><area shape="rect" id="node18" href="classmodule__cell.html#ac9479702e38648052df3b94e47fd6e64" title="module_cell::update\l_cells" alt="" coords="883,129,1034,170"/><area shape="rect" id="node20" href="TOPLATS__DRIVER_8f90.html#a1172731b68e0187d74326a81c0d80390" title="TOPLATS interface." alt="" coords="1083,136,1192,163"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3bdd723bb1b1abc4d9177409c216d3ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real*8 function module_atmos::clcf3vpd </td>
          <td>(</td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>ea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>g</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the limiting factor due to vapor pressure for canopy resistance following Jarvis (1976), Dickenson et al. (1986), Noilhan and Planton (1989) </p>

<p>Definition at line <a class="el" href="MODULE__ATMOS_8f90_source.html#l01400">1400</a> of file <a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a>.</p>

<p>References <a class="el" href="MODULE__ATMOS_8f90_source.html#l01311">esat()</a>.</p>

<p>Referenced by <a class="el" href="TESTS__DRIVER_8f90_source.html#l00033">module_unit_tests::clcf3vpd_test1()</a>, <a class="el" href="TESTS__DRIVER_8f90_source.html#l00042">module_unit_tests::clcf3vpd_test2()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l00729">peteb()</a>, and <a class="el" href="MODULE__ATMOS_8f90_source.html#l00557">petpen()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_a3bdd723bb1b1abc4d9177409c216d3ad_cgraph.png" border="0" usemap="#classmodule__atmos_a3bdd723bb1b1abc4d9177409c216d3ad_cgraph" alt=""/></div>
<map name="classmodule__atmos_a3bdd723bb1b1abc4d9177409c216d3ad_cgraph" id="classmodule__atmos_a3bdd723bb1b1abc4d9177409c216d3ad_cgraph">
<area shape="rect" id="node3" href="classmodule__atmos.html#af0c98f0d3f8ccaee29fa3742461f8ffc" title="Compute saturation vapor pressure in Pa. given temperature in Kelvin." alt="" coords="232,5,387,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_a3bdd723bb1b1abc4d9177409c216d3ad_icgraph.png" border="0" usemap="#classmodule__atmos_a3bdd723bb1b1abc4d9177409c216d3ad_icgraph" alt=""/></div>
<map name="classmodule__atmos_a3bdd723bb1b1abc4d9177409c216d3ad_icgraph" id="classmodule__atmos_a3bdd723bb1b1abc4d9177409c216d3ad_icgraph">
<area shape="rect" id="node3" href="classmodule__unit__tests.html#aaf5b8145b11e85f16c42046cd10ddaae" title="module_unit_tests::\lclcf3vpd_test1" alt="" coords="243,5,391,46"/><area shape="rect" id="node9" href="classmodule__unit__tests.html#a2a5377311e7155f96013e7be0e4d378a" title="module_unit_tests::\lclcf3vpd_test2" alt="" coords="243,70,391,111"/><area shape="rect" id="node12" href="classmodule__atmos.html#a5b61eacddb768855ab7cc5e532a4a3cd" title="Subroutine to calculate the potential evapotranspiration using the combination method (i..." alt="" coords="236,136,399,163"/><area shape="rect" id="node22" href="classmodule__atmos.html#a37a213735f0eb4c1e3b7a6e495f8f84b" title="Subroutine to calculate the potential evapotranspiration using penman&#39;s equation for bare soil and pe..." alt="" coords="232,187,403,213"/><area shape="rect" id="node5" href="classmodule__unit__tests.html#a3f4e9bd4cff4b73206b3c6a2d2414d7f" title="module_unit_tests::\lrun_unit_tests" alt="" coords="461,58,609,99"/><area shape="rect" id="node7" href="TESTS__DRIVER_8f90.html#aff76d0cacdf10182d98bc48b22593f1a" title="tests_driver" alt="" coords="707,65,805,92"/><area shape="rect" id="node14" href="classmodule__atmos.html#a9ac7d8cfa7a9cb7111c7bff5633ff009" title="module_atmos::atmos" alt="" coords="451,149,618,176"/><area shape="rect" id="node16" href="classmodule__cell.html#a70b7ade0b81899a7b22cef286c3a608b" title="module_cell::update_cell" alt="" coords="667,149,845,176"/><area shape="rect" id="node18" href="classmodule__cell.html#ac9479702e38648052df3b94e47fd6e64" title="module_cell::update\l_cells" alt="" coords="894,142,1045,183"/><area shape="rect" id="node20" href="TOPLATS__DRIVER_8f90.html#a1172731b68e0187d74326a81c0d80390" title="TOPLATS interface." alt="" coords="1093,149,1203,176"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a46811b0c944e97060dbc57b0ee132e06"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real*8 function module_atmos::clcf4temp </td>
          <td>(</td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>f4par</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the limiting factor due to air temperature for canopy resistance following Jarvis (1976), Dickenson et al. (1986), Noilhan and Planton (1989) </p>

<p>Definition at line <a class="el" href="MODULE__ATMOS_8f90_source.html#l01457">1457</a> of file <a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a>.</p>

<p>Referenced by <a class="el" href="TESTS__DRIVER_8f90_source.html#l00051">module_unit_tests::clcf4temp_test1()</a>, <a class="el" href="TESTS__DRIVER_8f90_source.html#l00060">module_unit_tests::clcf4temp_test2()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l00729">peteb()</a>, and <a class="el" href="MODULE__ATMOS_8f90_source.html#l00557">petpen()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_a46811b0c944e97060dbc57b0ee132e06_icgraph.png" border="0" usemap="#classmodule__atmos_a46811b0c944e97060dbc57b0ee132e06_icgraph" alt=""/></div>
<map name="classmodule__atmos_a46811b0c944e97060dbc57b0ee132e06_icgraph" id="classmodule__atmos_a46811b0c944e97060dbc57b0ee132e06_icgraph">
<area shape="rect" id="node3" href="classmodule__unit__tests.html#aad075e6fccb7beee4328e2f1db574d27" title="module_unit_tests::\lclcf4temp_test1" alt="" coords="254,5,402,46"/><area shape="rect" id="node9" href="classmodule__unit__tests.html#a61490b7a9ad1c428d8e898da55adefc6" title="module_unit_tests::\lclcf4temp_test2" alt="" coords="254,70,402,111"/><area shape="rect" id="node12" href="classmodule__atmos.html#a5b61eacddb768855ab7cc5e532a4a3cd" title="Subroutine to calculate the potential evapotranspiration using the combination method (i..." alt="" coords="247,136,409,163"/><area shape="rect" id="node22" href="classmodule__atmos.html#a37a213735f0eb4c1e3b7a6e495f8f84b" title="Subroutine to calculate the potential evapotranspiration using penman&#39;s equation for bare soil and pe..." alt="" coords="243,187,413,213"/><area shape="rect" id="node5" href="classmodule__unit__tests.html#a3f4e9bd4cff4b73206b3c6a2d2414d7f" title="module_unit_tests::\lrun_unit_tests" alt="" coords="471,58,619,99"/><area shape="rect" id="node7" href="TESTS__DRIVER_8f90.html#aff76d0cacdf10182d98bc48b22593f1a" title="tests_driver" alt="" coords="718,65,815,92"/><area shape="rect" id="node14" href="classmodule__atmos.html#a9ac7d8cfa7a9cb7111c7bff5633ff009" title="module_atmos::atmos" alt="" coords="462,149,629,176"/><area shape="rect" id="node16" href="classmodule__cell.html#a70b7ade0b81899a7b22cef286c3a608b" title="module_cell::update_cell" alt="" coords="677,149,856,176"/><area shape="rect" id="node18" href="classmodule__cell.html#ac9479702e38648052df3b94e47fd6e64" title="module_cell::update\l_cells" alt="" coords="905,142,1055,183"/><area shape="rect" id="node20" href="TOPLATS__DRIVER_8f90.html#a1172731b68e0187d74326a81c0d80390" title="TOPLATS interface." alt="" coords="1104,149,1213,176"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af0c98f0d3f8ccaee29fa3742461f8ffc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real*8 function module_atmos::esat </td>
          <td>(</td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Tsk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute saturation vapor pressure in Pa. given temperature in Kelvin. </p>

<p>Definition at line <a class="el" href="MODULE__ATMOS_8f90_source.html#l01311">1311</a> of file <a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a>.</p>

<p>Referenced by <a class="el" href="MODULE__ATMOS_8f90_source.html#l01400">clcf3vpd()</a>, <a class="el" href="TESTS__DRIVER_8f90_source.html#l00144">module_unit_tests::esat_test1()</a>, and <a class="el" href="TESTS__DRIVER_8f90_source.html#l00153">module_unit_tests::esat_test2()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_af0c98f0d3f8ccaee29fa3742461f8ffc_icgraph.png" border="0" usemap="#classmodule__atmos_af0c98f0d3f8ccaee29fa3742461f8ffc_icgraph" alt=""/></div>
<map name="classmodule__atmos_af0c98f0d3f8ccaee29fa3742461f8ffc_icgraph" id="classmodule__atmos_af0c98f0d3f8ccaee29fa3742461f8ffc_icgraph">
<area shape="rect" id="node3" href="classmodule__atmos.html#a3bdd723bb1b1abc4d9177409c216d3ad" title="Calculate the limiting factor due to vapor pressure for canopy resistance following Jarvis (1976)..." alt="" coords="208,115,387,141"/><area shape="rect" id="node27" href="classmodule__unit__tests.html#ac87ed3bbeef109edda2350cfc0a8ebec" title="module_unit_tests::\lesat_test1" alt="" coords="223,217,371,258"/><area shape="rect" id="node30" href="classmodule__unit__tests.html#aefaa44ce4c47cfc5e68f3db7782e7651" title="module_unit_tests::\lesat_test2" alt="" coords="223,282,371,323"/><area shape="rect" id="node5" href="classmodule__unit__tests.html#aaf5b8145b11e85f16c42046cd10ddaae" title="module_unit_tests::\lclcf3vpd_test1" alt="" coords="446,107,594,149"/><area shape="rect" id="node11" href="classmodule__unit__tests.html#a2a5377311e7155f96013e7be0e4d378a" title="module_unit_tests::\lclcf3vpd_test2" alt="" coords="446,173,594,214"/><area shape="rect" id="node14" href="classmodule__atmos.html#a5b61eacddb768855ab7cc5e532a4a3cd" title="Subroutine to calculate the potential evapotranspiration using the combination method (i..." alt="" coords="439,5,601,32"/><area shape="rect" id="node24" href="classmodule__atmos.html#a37a213735f0eb4c1e3b7a6e495f8f84b" title="Subroutine to calculate the potential evapotranspiration using penman&#39;s equation for bare soil and pe..." alt="" coords="435,56,605,83"/><area shape="rect" id="node7" href="classmodule__unit__tests.html#a3f4e9bd4cff4b73206b3c6a2d2414d7f" title="module_unit_tests::\lrun_unit_tests" alt="" coords="663,202,811,243"/><area shape="rect" id="node9" href="TESTS__DRIVER_8f90.html#aff76d0cacdf10182d98bc48b22593f1a" title="tests_driver" alt="" coords="910,209,1007,236"/><area shape="rect" id="node16" href="classmodule__atmos.html#a9ac7d8cfa7a9cb7111c7bff5633ff009" title="module_atmos::atmos" alt="" coords="654,31,821,57"/><area shape="rect" id="node18" href="classmodule__cell.html#a70b7ade0b81899a7b22cef286c3a608b" title="module_cell::update_cell" alt="" coords="869,31,1048,57"/><area shape="rect" id="node20" href="classmodule__cell.html#ac9479702e38648052df3b94e47fd6e64" title="module_cell::update\l_cells" alt="" coords="1097,23,1247,65"/><area shape="rect" id="node22" href="TOPLATS__DRIVER_8f90.html#a1172731b68e0187d74326a81c0d80390" title="TOPLATS interface." alt="" coords="1296,31,1405,57"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a006b822a8fc84cc2657a18e0bddaeac3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_atmos::inidum </td>
          <td>(</td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dum1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>PackWater</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dum2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>SurfWater</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dum3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Swq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dum4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>VaporMassFlux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dum5</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>TPack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dum6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>TSurf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dum7</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>r_MeltEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dum8</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Outflow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dum9</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xleact_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dum10</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>hact_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dum11</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rn_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dum12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dens</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the snow model variables that will be used in the snow subroutine but that not will be altered in the main program. </p>

<p>Definition at line <a class="el" href="MODULE__ATMOS_8f90_source.html#l01880">1880</a> of file <a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a>.</p>

<p>Referenced by <a class="el" href="MODULE__ATMOS_8f90_source.html#l01511">peteb_bs()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l01635">peteb_dv()</a>, and <a class="el" href="MODULE__ATMOS_8f90_source.html#l01747">peteb_wv()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_a006b822a8fc84cc2657a18e0bddaeac3_icgraph.png" border="0" usemap="#classmodule__atmos_a006b822a8fc84cc2657a18e0bddaeac3_icgraph" alt=""/></div>
<map name="classmodule__atmos_a006b822a8fc84cc2657a18e0bddaeac3_icgraph" id="classmodule__atmos_a006b822a8fc84cc2657a18e0bddaeac3_icgraph">
<area shape="rect" id="node3" href="classmodule__atmos.html#a256a2fff00e163f0ae8dcdcc8761592c" title="Solve the energy balance at potential rate for bare soil." alt="" coords="225,5,410,32"/><area shape="rect" id="node15" href="classmodule__atmos.html#ad27d1fb1ddac9bbb1ea4699a18eba7df" title="Solve the energy balance at potential rate for dry vegetation, over story." alt="" coords="225,56,410,83"/><area shape="rect" id="node18" href="classmodule__atmos.html#ab1d70ea42fba682b775505cb9d8ffcde" title="Solve the energy balance at potential rate for wet vegetation, over story." alt="" coords="224,107,411,133"/><area shape="rect" id="node5" href="classmodule__atmos.html#a5b61eacddb768855ab7cc5e532a4a3cd" title="Subroutine to calculate the potential evapotranspiration using the combination method (i..." alt="" coords="459,56,621,83"/><area shape="rect" id="node7" href="classmodule__atmos.html#a9ac7d8cfa7a9cb7111c7bff5633ff009" title="module_atmos::atmos" alt="" coords="670,56,837,83"/><area shape="rect" id="node9" href="classmodule__cell.html#a70b7ade0b81899a7b22cef286c3a608b" title="module_cell::update_cell" alt="" coords="885,56,1064,83"/><area shape="rect" id="node11" href="classmodule__cell.html#ac9479702e38648052df3b94e47fd6e64" title="module_cell::update\l_cells" alt="" coords="1113,49,1263,90"/><area shape="rect" id="node13" href="TOPLATS__DRIVER_8f90.html#a1172731b68e0187d74326a81c0d80390" title="TOPLATS interface." alt="" coords="1312,56,1421,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac2a76462207d01141c5eda614aa2fbea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_atmos::inittk </td>
          <td>(</td>
          <td class="paramtype">type (grid_soil_template)&#160;</td>
          <td class="paramname"><em>GRID_SOIL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (grid_veg_template)&#160;</td>
          <td class="paramname"><em>GRID_VEG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (grid_vars_template)&#160;</td>
          <td class="paramname"><em>GRID_VARS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tdeep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tmid0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tmid0_moss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkmid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkmid_us</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkmid_moss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tk0moss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkact_us</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkact_moss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tskinact_moss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dshact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dshact_us</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dshact_moss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkpet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkmidpet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkmidpet_us</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkmidpet_moss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dspet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dspet_us</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dspet_moss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Tsurf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Tpack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Tsurf_us</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Tpack_us</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to assign initial soil temperatures and set heat storage variables for the first time step in the simulation. </p>

<p>Definition at line <a class="el" href="MODULE__ATMOS_8f90_source.html#l00427">427</a> of file <a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a>.</p>

<p>Referenced by <a class="el" href="MODULE__ATMOS_8f90_source.html#l00034">atmos()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_ac2a76462207d01141c5eda614aa2fbea_icgraph.png" border="0" usemap="#classmodule__atmos_ac2a76462207d01141c5eda614aa2fbea_icgraph" alt=""/></div>
<map name="classmodule__atmos_ac2a76462207d01141c5eda614aa2fbea_icgraph" id="classmodule__atmos_ac2a76462207d01141c5eda614aa2fbea_icgraph">
<area shape="rect" id="node3" href="classmodule__atmos.html#a9ac7d8cfa7a9cb7111c7bff5633ff009" title="module_atmos::atmos" alt="" coords="211,12,378,39"/><area shape="rect" id="node5" href="classmodule__cell.html#a70b7ade0b81899a7b22cef286c3a608b" title="module_cell::update_cell" alt="" coords="427,12,605,39"/><area shape="rect" id="node7" href="classmodule__cell.html#ac9479702e38648052df3b94e47fd6e64" title="module_cell::update\l_cells" alt="" coords="654,5,805,46"/><area shape="rect" id="node9" href="TOPLATS__DRIVER_8f90.html#a1172731b68e0187d74326a81c0d80390" title="TOPLATS interface." alt="" coords="853,12,963,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5b61eacddb768855ab7cc5e532a4a3cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_atmos::peteb </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ipix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>inc_frozen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the potential evapotranspiration using the combination method (i.e. solving the set of nonlinear energy balance equations iteratively). three energy balances are maintained: one for bare soil, one for wet vegetation and one for dry vegetation. </p>
<p>This is the subroutine that solves the energy balance under the assumption that the incoming long wave radiation for both under and over story is equal. </p>

<p>Definition at line <a class="el" href="MODULE__ATMOS_8f90_source.html#l00729">729</a> of file <a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a>.</p>

<p>References <a class="el" href="MODULE__SHARED_8f90_source.html#l00222">module_shared::calc_rs()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l01359">clcf1par()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l01400">clcf3vpd()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l01457">clcf4temp()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l01511">peteb_bs()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l01635">peteb_dv()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l01747">peteb_wv()</a>, <a class="el" href="MODULE__SHARED_8f90_source.html#l00184">module_shared::sm_cen_dif()</a>, <a class="el" href="MODULE__SHARED_8f90_source.html#l00021">module_shared::soiladapt()</a>, and <a class="el" href="MODULE__SHARED_8f90_source.html#l00112">module_shared::soiltherm()</a>.</p>

<p>Referenced by <a class="el" href="MODULE__ATMOS_8f90_source.html#l00034">atmos()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_a5b61eacddb768855ab7cc5e532a4a3cd_cgraph.png" border="0" usemap="#classmodule__atmos_a5b61eacddb768855ab7cc5e532a4a3cd_cgraph" alt=""/></div>
<map name="classmodule__atmos_a5b61eacddb768855ab7cc5e532a4a3cd_cgraph" id="classmodule__atmos_a5b61eacddb768855ab7cc5e532a4a3cd_cgraph">
<area shape="rect" id="node3" href="classmodule__shared.html#a5853589e5ecabcd610401615791e1b1c" title="Calculate the incoming solar radiation for the under and over story under the assumption of only one ..." alt="" coords="231,5,404,32"/><area shape="rect" id="node5" href="classmodule__atmos.html#a0ccd83fc7c711ad05ee1ee05f77fa0c8" title="Calculate the limiting factor due to Photosynthetically Active Radiation (PAR) for canopy resistance ..." alt="" coords="229,56,405,83"/><area shape="rect" id="node7" href="classmodule__atmos.html#a3bdd723bb1b1abc4d9177409c216d3ad" title="Calculate the limiting factor due to vapor pressure for canopy resistance following Jarvis (1976)..." alt="" coords="228,107,407,133"/><area shape="rect" id="node11" href="classmodule__atmos.html#a46811b0c944e97060dbc57b0ee132e06" title="Calculate the limiting factor due to air temperature for canopy resistance following Jarvis (1976)..." alt="" coords="223,157,412,184"/><area shape="rect" id="node13" href="classmodule__atmos.html#a256a2fff00e163f0ae8dcdcc8761592c" title="Solve the energy balance at potential rate for bare soil." alt="" coords="225,208,410,235"/><area shape="rect" id="node32" href="classmodule__atmos.html#ad27d1fb1ddac9bbb1ea4699a18eba7df" title="Solve the energy balance at potential rate for dry vegetation, over story." alt="" coords="225,259,410,285"/><area shape="rect" id="node38" href="classmodule__atmos.html#ab1d70ea42fba682b775505cb9d8ffcde" title="Solve the energy balance at potential rate for wet vegetation, over story." alt="" coords="224,309,411,336"/><area shape="rect" id="node50" href="classmodule__shared.html#ab1e0fcd7b943d6d47ec1467b04295c57" title="Initialize soil moisture for the calculation of the thermodynami parameters, as a centered difference..." alt="" coords="217,360,418,387"/><area shape="rect" id="node52" href="classmodule__shared.html#af41c791600df378bb52d6b76fe3bec4e" title="Adapt the thermal parameters for vegetated surfaces." alt="" coords="224,411,411,437"/><area shape="rect" id="node54" href="classmodule__shared.html#a3035d2077015b1668623b5e23b9f95a5" title="Calculate the soil thermal parameters." alt="" coords="223,487,412,513"/><area shape="rect" id="node9" href="classmodule__atmos.html#af0c98f0d3f8ccaee29fa3742461f8ffc" title="Compute saturation vapor pressure in Pa. given temperature in Kelvin." alt="" coords="491,107,645,133"/><area shape="rect" id="node15" href="classmodule__shared.html#af8d6172a7faee4205abe3a393491e55e" title="module_shared::nreb" alt="" coords="489,157,647,184"/><area shape="rect" id="node17" href="classmodule__atmos.html#a006b822a8fc84cc2657a18e0bddaeac3" title="Initialize the snow model variables that will be used in the snow subroutine but that not will be alt..." alt="" coords="483,208,653,235"/><area shape="rect" id="node19" href="classmodule__snow.html#a7384dfa1b5cc4f948970cd65bcea94c8" title="Calculate snow accumulation and melt using an energy balance approach for a two layer snow model..." alt="" coords="467,259,669,285"/><area shape="rect" id="node30" href="classmodule__shared.html#a46957caed7b9b6c216cb9d3d3da2d34a" title="module_shared::nreb_snow" alt="" coords="469,309,667,336"/><area shape="rect" id="node21" href="classmodule__snow.html#aba96f18deffc8a88948404c04b964aab" title="Calculate the surface energy balance for the snow pack." alt="" coords="945,259,1218,285"/><area shape="rect" id="node27" href="classmodule__snow.html#a01052a35c199bd967c88f505f5a9ea0e" title="Calculate the surface temperature in the absence of snow." alt="" coords="718,284,895,311"/><area shape="rect" id="node23" href="classmodule__snow.html#ab071adc15b6a3d9eeec011e963c7f024" title="Calculate atmospheri! stability correction for non&#45;neutral conditions." alt="" coords="1267,233,1498,260"/><area shape="rect" id="node25" href="classmodule__snow.html#a906b9ae113669804289e3ead4ea25112" title="Calculate the saturated vapor pressure in the snow pack." alt="" coords="1268,284,1497,311"/><area shape="rect" id="node41" href="classmodule__shared.html#a2a0724bfbc1d78552bf96b93956b08ca" title="Subroutine to calculate all variables related to stability correction and aerodynami! resistances..." alt="" coords="479,360,657,387"/><area shape="rect" id="node45" href="classmodule__shared.html#a57fd8f76c675564f50596c4188b00485" title="module_shared::calcra" alt="" coords="485,411,651,437"/><area shape="rect" id="node43" href="classmodule__shared.html#a50955cdddd2ff32a49f43ac35f1f41a2" title="Calculate Bulk Richardson number based on input temperature, humidity, pressure, wind profile..." alt="" coords="721,360,892,387"/><area shape="rect" id="node56" href="classmodule__shared.html#ab612ad0ea7a26f361a65d9f726ca5a0e" title="module_shared::calctc_m" alt="" coords="475,461,661,488"/><area shape="rect" id="node58" href="classmodule__shared.html#a9d7b9c5c70ac25f2cfbf280981ef6301" title="Calculate the thermal conductivity (thermc) of an unsaturated soil using Johansen&#39;s method..." alt="" coords="480,512,656,539"/><area shape="rect" id="node60" href="classmodule__shared.html#abeb649a221f7f2002b81d5ada56ee6bc" title="Calculate the heat capacity of the soil using the input soil moisture requested (theta), and saturated soil moisture or porosity (thetasat). Heat capacity found as density&#45;weighted combination of soil, water and air heat capacities." alt="" coords="483,563,653,589"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_a5b61eacddb768855ab7cc5e532a4a3cd_icgraph.png" border="0" usemap="#classmodule__atmos_a5b61eacddb768855ab7cc5e532a4a3cd_icgraph" alt=""/></div>
<map name="classmodule__atmos_a5b61eacddb768855ab7cc5e532a4a3cd_icgraph" id="classmodule__atmos_a5b61eacddb768855ab7cc5e532a4a3cd_icgraph">
<area shape="rect" id="node3" href="classmodule__atmos.html#a9ac7d8cfa7a9cb7111c7bff5633ff009" title="module_atmos::atmos" alt="" coords="217,12,383,39"/><area shape="rect" id="node5" href="classmodule__cell.html#a70b7ade0b81899a7b22cef286c3a608b" title="module_cell::update_cell" alt="" coords="432,12,611,39"/><area shape="rect" id="node7" href="classmodule__cell.html#ac9479702e38648052df3b94e47fd6e64" title="module_cell::update\l_cells" alt="" coords="659,5,810,46"/><area shape="rect" id="node9" href="TOPLATS__DRIVER_8f90.html#a1172731b68e0187d74326a81c0d80390" title="TOPLATS interface." alt="" coords="859,12,968,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a256a2fff00e163f0ae8dcdcc8761592c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_atmos::peteb_bs </td>
          <td>(</td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>thermc1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>thermc2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>heatcap1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>heatcap2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>heatcapold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Swq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>albd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>emiss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>ravd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rahd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkmidd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rnetd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>epetd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>hd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>gd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dshd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tcel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>vppa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>roa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>psychr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xlhv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>zdeep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Tdeepstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>zmid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>toleb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>maxnri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkmidw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rnetw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xlew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>epetw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>hw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>gw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dshw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>ravw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rahw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>PackWater</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>SurfWater</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>VaporMassFlux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>TPack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>TSurf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>r_MeltEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Outflow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xleact_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>hact_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rn_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>za</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>zpd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>albw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>z0h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>RaSnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>alb_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>appa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>vpsat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>uzw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>gact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>row</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve the energy balance at potential rate for bare soil. </p>

<p>Definition at line <a class="el" href="MODULE__ATMOS_8f90_source.html#l01511">1511</a> of file <a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a>.</p>

<p>References <a class="el" href="MODULE__SNOW_8f90_source.html#l00086">module_snow::calcsnowmelt()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l01880">inidum()</a>, <a class="el" href="MODULE__SHARED_8f90_source.html#l00808">module_shared::nreb()</a>, and <a class="el" href="MODULE__SHARED_8f90_source.html#l01172">module_shared::nreb_snow()</a>.</p>

<p>Referenced by <a class="el" href="MODULE__ATMOS_8f90_source.html#l00729">peteb()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_a256a2fff00e163f0ae8dcdcc8761592c_cgraph.png" border="0" usemap="#classmodule__atmos_a256a2fff00e163f0ae8dcdcc8761592c_cgraph" alt=""/></div>
<map name="classmodule__atmos_a256a2fff00e163f0ae8dcdcc8761592c_cgraph" id="classmodule__atmos_a256a2fff00e163f0ae8dcdcc8761592c_cgraph">
<area shape="rect" id="node3" href="classmodule__snow.html#a7384dfa1b5cc4f948970cd65bcea94c8" title="Calculate snow accumulation and melt using an energy balance approach for a two layer snow model..." alt="" coords="240,31,443,57"/><area shape="rect" id="node14" href="classmodule__atmos.html#a006b822a8fc84cc2657a18e0bddaeac3" title="Initialize the snow model variables that will be used in the snow subroutine but that not will be alt..." alt="" coords="257,81,426,108"/><area shape="rect" id="node16" href="classmodule__shared.html#af8d6172a7faee4205abe3a393491e55e" title="module_shared::nreb" alt="" coords="262,132,421,159"/><area shape="rect" id="node18" href="classmodule__shared.html#a46957caed7b9b6c216cb9d3d3da2d34a" title="module_shared::nreb_snow" alt="" coords="243,183,440,209"/><area shape="rect" id="node5" href="classmodule__snow.html#aba96f18deffc8a88948404c04b964aab" title="Calculate the surface energy balance for the snow pack." alt="" coords="718,31,991,57"/><area shape="rect" id="node11" href="classmodule__snow.html#a01052a35c199bd967c88f505f5a9ea0e" title="Calculate the surface temperature in the absence of snow." alt="" coords="491,56,669,83"/><area shape="rect" id="node7" href="classmodule__snow.html#ab071adc15b6a3d9eeec011e963c7f024" title="Calculate atmospheri! stability correction for non&#45;neutral conditions." alt="" coords="1041,5,1271,32"/><area shape="rect" id="node9" href="classmodule__snow.html#a906b9ae113669804289e3ead4ea25112" title="Calculate the saturated vapor pressure in the snow pack." alt="" coords="1041,56,1271,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_a256a2fff00e163f0ae8dcdcc8761592c_icgraph.png" border="0" usemap="#classmodule__atmos_a256a2fff00e163f0ae8dcdcc8761592c_icgraph" alt=""/></div>
<map name="classmodule__atmos_a256a2fff00e163f0ae8dcdcc8761592c_icgraph" id="classmodule__atmos_a256a2fff00e163f0ae8dcdcc8761592c_icgraph">
<area shape="rect" id="node3" href="classmodule__atmos.html#a5b61eacddb768855ab7cc5e532a4a3cd" title="Subroutine to calculate the potential evapotranspiration using the combination method (i..." alt="" coords="240,12,403,39"/><area shape="rect" id="node5" href="classmodule__atmos.html#a9ac7d8cfa7a9cb7111c7bff5633ff009" title="module_atmos::atmos" alt="" coords="451,12,618,39"/><area shape="rect" id="node7" href="classmodule__cell.html#a70b7ade0b81899a7b22cef286c3a608b" title="module_cell::update_cell" alt="" coords="667,12,845,39"/><area shape="rect" id="node9" href="classmodule__cell.html#ac9479702e38648052df3b94e47fd6e64" title="module_cell::update\l_cells" alt="" coords="894,5,1045,46"/><area shape="rect" id="node11" href="TOPLATS__DRIVER_8f90.html#a1172731b68e0187d74326a81c0d80390" title="TOPLATS interface." alt="" coords="1093,12,1203,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad27d1fb1ddac9bbb1ea4699a18eba7df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_atmos::peteb_dv </td>
          <td>(</td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>thermc2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>vpsat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>heatcap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>heatcap2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>heatcapold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rs_over</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Swq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>albd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>emiss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>thermc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>f1par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>f3vpd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>f4temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rescan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>ravd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rahd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkmidd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rnetd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>epetd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>hd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>gd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dshd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tcel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>vppa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>roa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>psychr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xlhv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>zdeep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Tdeepstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>zmid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>toleb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>maxnri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>PackWater</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>SurfWater</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>VaporMassFlux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>TPack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>TSurf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>r_MeltEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Outflow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xleact_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>hact_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rn_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>za</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>zpd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>z0h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>RaSnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>appa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>uzw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>gact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>alb_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>row</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve the energy balance at potential rate for dry vegetation, over story. </p>

<p>Definition at line <a class="el" href="MODULE__ATMOS_8f90_source.html#l01635">1635</a> of file <a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a>.</p>

<p>References <a class="el" href="MODULE__SNOW_8f90_source.html#l00086">module_snow::calcsnowmelt()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l01880">inidum()</a>, <a class="el" href="MODULE__SHARED_8f90_source.html#l00808">module_shared::nreb()</a>, and <a class="el" href="MODULE__SHARED_8f90_source.html#l01172">module_shared::nreb_snow()</a>.</p>

<p>Referenced by <a class="el" href="MODULE__ATMOS_8f90_source.html#l00729">peteb()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_ad27d1fb1ddac9bbb1ea4699a18eba7df_cgraph.png" border="0" usemap="#classmodule__atmos_ad27d1fb1ddac9bbb1ea4699a18eba7df_cgraph" alt=""/></div>
<map name="classmodule__atmos_ad27d1fb1ddac9bbb1ea4699a18eba7df_cgraph" id="classmodule__atmos_ad27d1fb1ddac9bbb1ea4699a18eba7df_cgraph">
<area shape="rect" id="node3" href="classmodule__snow.html#a7384dfa1b5cc4f948970cd65bcea94c8" title="Calculate snow accumulation and melt using an energy balance approach for a two layer snow model..." alt="" coords="240,31,443,57"/><area shape="rect" id="node14" href="classmodule__atmos.html#a006b822a8fc84cc2657a18e0bddaeac3" title="Initialize the snow model variables that will be used in the snow subroutine but that not will be alt..." alt="" coords="257,81,426,108"/><area shape="rect" id="node16" href="classmodule__shared.html#af8d6172a7faee4205abe3a393491e55e" title="module_shared::nreb" alt="" coords="262,132,421,159"/><area shape="rect" id="node18" href="classmodule__shared.html#a46957caed7b9b6c216cb9d3d3da2d34a" title="module_shared::nreb_snow" alt="" coords="243,183,440,209"/><area shape="rect" id="node5" href="classmodule__snow.html#aba96f18deffc8a88948404c04b964aab" title="Calculate the surface energy balance for the snow pack." alt="" coords="718,31,991,57"/><area shape="rect" id="node11" href="classmodule__snow.html#a01052a35c199bd967c88f505f5a9ea0e" title="Calculate the surface temperature in the absence of snow." alt="" coords="491,56,669,83"/><area shape="rect" id="node7" href="classmodule__snow.html#ab071adc15b6a3d9eeec011e963c7f024" title="Calculate atmospheri! stability correction for non&#45;neutral conditions." alt="" coords="1041,5,1271,32"/><area shape="rect" id="node9" href="classmodule__snow.html#a906b9ae113669804289e3ead4ea25112" title="Calculate the saturated vapor pressure in the snow pack." alt="" coords="1041,56,1271,83"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_ad27d1fb1ddac9bbb1ea4699a18eba7df_icgraph.png" border="0" usemap="#classmodule__atmos_ad27d1fb1ddac9bbb1ea4699a18eba7df_icgraph" alt=""/></div>
<map name="classmodule__atmos_ad27d1fb1ddac9bbb1ea4699a18eba7df_icgraph" id="classmodule__atmos_ad27d1fb1ddac9bbb1ea4699a18eba7df_icgraph">
<area shape="rect" id="node3" href="classmodule__atmos.html#a5b61eacddb768855ab7cc5e532a4a3cd" title="Subroutine to calculate the potential evapotranspiration using the combination method (i..." alt="" coords="240,12,403,39"/><area shape="rect" id="node5" href="classmodule__atmos.html#a9ac7d8cfa7a9cb7111c7bff5633ff009" title="module_atmos::atmos" alt="" coords="451,12,618,39"/><area shape="rect" id="node7" href="classmodule__cell.html#a70b7ade0b81899a7b22cef286c3a608b" title="module_cell::update_cell" alt="" coords="667,12,845,39"/><area shape="rect" id="node9" href="classmodule__cell.html#ac9479702e38648052df3b94e47fd6e64" title="module_cell::update\l_cells" alt="" coords="894,5,1045,46"/><area shape="rect" id="node11" href="TOPLATS__DRIVER_8f90.html#a1172731b68e0187d74326a81c0d80390" title="TOPLATS interface." alt="" coords="1093,12,1203,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab1d70ea42fba682b775505cb9d8ffcde"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_atmos::peteb_wv </td>
          <td>(</td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>thermc2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>heatcap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>heatcap2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>heatcapold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rs_over</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Swq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>albw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>emiss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>thermc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>ravw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rahw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkmidw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rnetw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xlew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>epetw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>hw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>gw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dshw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tcel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>vppa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>roa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>psychr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xlhv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>zdeep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Tdeepstep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>zmid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>toleb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>maxnri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>iopstab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>zww</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>za</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>uzw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>zpd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>z0m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>press</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>z0h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>PackWater</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>SurfWater</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>VaporMassFlux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>TPack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>TSurf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>r_MeltEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Outflow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xleact_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>hact_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rn_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>dens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>RaSnow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>alb_snow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>appa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>vpsat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>gact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ipix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve the energy balance at potential rate for wet vegetation, over story. </p>

<p>Definition at line <a class="el" href="MODULE__ATMOS_8f90_source.html#l01747">1747</a> of file <a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a>.</p>

<p>References <a class="el" href="MODULE__SHARED_8f90_source.html#l01249">module_shared::calcra()</a>, <a class="el" href="MODULE__SNOW_8f90_source.html#l00086">module_snow::calcsnowmelt()</a>, <a class="el" href="MODULE__ATMOS_8f90_source.html#l01880">inidum()</a>, <a class="el" href="MODULE__SHARED_8f90_source.html#l00808">module_shared::nreb()</a>, <a class="el" href="MODULE__SHARED_8f90_source.html#l01172">module_shared::nreb_snow()</a>, and <a class="el" href="MODULE__SHARED_8f90_source.html#l00440">module_shared::stabcor()</a>.</p>

<p>Referenced by <a class="el" href="MODULE__ATMOS_8f90_source.html#l00729">peteb()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_ab1d70ea42fba682b775505cb9d8ffcde_cgraph.png" border="0" usemap="#classmodule__atmos_ab1d70ea42fba682b775505cb9d8ffcde_cgraph" alt=""/></div>
<map name="classmodule__atmos_ab1d70ea42fba682b775505cb9d8ffcde_cgraph" id="classmodule__atmos_ab1d70ea42fba682b775505cb9d8ffcde_cgraph">
<area shape="rect" id="node3" href="classmodule__shared.html#a57fd8f76c675564f50596c4188b00485" title="module_shared::calcra" alt="" coords="258,5,425,32"/><area shape="rect" id="node5" href="classmodule__snow.html#a7384dfa1b5cc4f948970cd65bcea94c8" title="Calculate snow accumulation and melt using an energy balance approach for a two layer snow model..." alt="" coords="240,56,443,83"/><area shape="rect" id="node16" href="classmodule__atmos.html#a006b822a8fc84cc2657a18e0bddaeac3" title="Initialize the snow model variables that will be used in the snow subroutine but that not will be alt..." alt="" coords="257,107,426,133"/><area shape="rect" id="node18" href="classmodule__shared.html#af8d6172a7faee4205abe3a393491e55e" title="module_shared::nreb" alt="" coords="262,157,421,184"/><area shape="rect" id="node20" href="classmodule__shared.html#a46957caed7b9b6c216cb9d3d3da2d34a" title="module_shared::nreb_snow" alt="" coords="243,208,440,235"/><area shape="rect" id="node22" href="classmodule__shared.html#a2a0724bfbc1d78552bf96b93956b08ca" title="Subroutine to calculate all variables related to stability correction and aerodynami! resistances..." alt="" coords="253,259,430,285"/><area shape="rect" id="node7" href="classmodule__snow.html#aba96f18deffc8a88948404c04b964aab" title="Calculate the surface energy balance for the snow pack." alt="" coords="718,56,991,83"/><area shape="rect" id="node13" href="classmodule__snow.html#a01052a35c199bd967c88f505f5a9ea0e" title="Calculate the surface temperature in the absence of snow." alt="" coords="491,81,669,108"/><area shape="rect" id="node9" href="classmodule__snow.html#ab071adc15b6a3d9eeec011e963c7f024" title="Calculate atmospheri! stability correction for non&#45;neutral conditions." alt="" coords="1041,31,1271,57"/><area shape="rect" id="node11" href="classmodule__snow.html#a906b9ae113669804289e3ead4ea25112" title="Calculate the saturated vapor pressure in the snow pack." alt="" coords="1041,81,1271,108"/><area shape="rect" id="node24" href="classmodule__shared.html#a50955cdddd2ff32a49f43ac35f1f41a2" title="Calculate Bulk Richardson number based on input temperature, humidity, pressure, wind profile..." alt="" coords="495,259,665,285"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_ab1d70ea42fba682b775505cb9d8ffcde_icgraph.png" border="0" usemap="#classmodule__atmos_ab1d70ea42fba682b775505cb9d8ffcde_icgraph" alt=""/></div>
<map name="classmodule__atmos_ab1d70ea42fba682b775505cb9d8ffcde_icgraph" id="classmodule__atmos_ab1d70ea42fba682b775505cb9d8ffcde_icgraph">
<area shape="rect" id="node3" href="classmodule__atmos.html#a5b61eacddb768855ab7cc5e532a4a3cd" title="Subroutine to calculate the potential evapotranspiration using the combination method (i..." alt="" coords="240,12,403,39"/><area shape="rect" id="node5" href="classmodule__atmos.html#a9ac7d8cfa7a9cb7111c7bff5633ff009" title="module_atmos::atmos" alt="" coords="451,12,618,39"/><area shape="rect" id="node7" href="classmodule__cell.html#a70b7ade0b81899a7b22cef286c3a608b" title="module_cell::update_cell" alt="" coords="667,12,845,39"/><area shape="rect" id="node9" href="classmodule__cell.html#ac9479702e38648052df3b94e47fd6e64" title="module_cell::update\l_cells" alt="" coords="894,5,1045,46"/><area shape="rect" id="node11" href="TOPLATS__DRIVER_8f90.html#a1172731b68e0187d74326a81c0d80390" title="TOPLATS interface." alt="" coords="1093,12,1203,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a37a213735f0eb4c1e3b7a6e495f8f84b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine module_atmos::petpen </td>
          <td>(</td>
          <td class="paramtype">type (grid_veg_template)&#160;</td>
          <td class="paramname"><em>GRID_VEG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (grid_met_template)&#160;</td>
          <td class="paramname"><em>GRID_MET</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (grid_vars_template)&#160;</td>
          <td class="paramname"><em>GRID_VARS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tcel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>vpsat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>vpdef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>f1par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>albd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xlai</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rsd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rsmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rsmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>Rpl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>tkel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>vppa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>f3vpd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>f3vpdpar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>f4temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>trefk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>f4temppar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rnetpn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>gbspen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rnetd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rnetw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>gd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>gw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>rescan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>ravd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xlhv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>epetd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>epetw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>ravw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>psychr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xled</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>xlew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>hd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>hw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real*8&#160;</td>
          <td class="paramname"><em>roa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to calculate the potential evapotranspiration using penman's equation for bare soil and penman-monteith for vegetated areas. </p>

<p>Definition at line <a class="el" href="MODULE__ATMOS_8f90_source.html#l00557">557</a> of file <a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a>.</p>

<p>References <a class="el" href="MODULE__ATMOS_8f90_source.html#l01400">clcf3vpd()</a>, and <a class="el" href="MODULE__ATMOS_8f90_source.html#l01457">clcf4temp()</a>.</p>

<p>Referenced by <a class="el" href="MODULE__ATMOS_8f90_source.html#l00034">atmos()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_a37a213735f0eb4c1e3b7a6e495f8f84b_cgraph.png" border="0" usemap="#classmodule__atmos_a37a213735f0eb4c1e3b7a6e495f8f84b_cgraph" alt=""/></div>
<map name="classmodule__atmos_a37a213735f0eb4c1e3b7a6e495f8f84b_cgraph" id="classmodule__atmos_a37a213735f0eb4c1e3b7a6e495f8f84b_cgraph">
<area shape="rect" id="node3" href="classmodule__atmos.html#a3bdd723bb1b1abc4d9177409c216d3ad" title="Calculate the limiting factor due to vapor pressure for canopy resistance following Jarvis (1976)..." alt="" coords="229,5,408,32"/><area shape="rect" id="node7" href="classmodule__atmos.html#a46811b0c944e97060dbc57b0ee132e06" title="Calculate the limiting factor due to air temperature for canopy resistance following Jarvis (1976)..." alt="" coords="224,56,413,83"/><area shape="rect" id="node5" href="classmodule__atmos.html#af0c98f0d3f8ccaee29fa3742461f8ffc" title="Compute saturation vapor pressure in Pa. given temperature in Kelvin." alt="" coords="461,5,616,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classmodule__atmos_a37a213735f0eb4c1e3b7a6e495f8f84b_icgraph.png" border="0" usemap="#classmodule__atmos_a37a213735f0eb4c1e3b7a6e495f8f84b_icgraph" alt=""/></div>
<map name="classmodule__atmos_a37a213735f0eb4c1e3b7a6e495f8f84b_icgraph" id="classmodule__atmos_a37a213735f0eb4c1e3b7a6e495f8f84b_icgraph">
<area shape="rect" id="node3" href="classmodule__atmos.html#a9ac7d8cfa7a9cb7111c7bff5633ff009" title="module_atmos::atmos" alt="" coords="225,12,391,39"/><area shape="rect" id="node5" href="classmodule__cell.html#a70b7ade0b81899a7b22cef286c3a608b" title="module_cell::update_cell" alt="" coords="440,12,619,39"/><area shape="rect" id="node7" href="classmodule__cell.html#ac9479702e38648052df3b94e47fd6e64" title="module_cell::update\l_cells" alt="" coords="667,5,818,46"/><area shape="rect" id="node9" href="TOPLATS__DRIVER_8f90.html#a1172731b68e0187d74326a81c0d80390" title="TOPLATS interface." alt="" coords="867,12,976,39"/></map>
</div>
</p>

</div>
</div>
<hr/>The documentation for this module was generated from the following file:<ul>
<li>MODEL/<a class="el" href="MODULE__ATMOS_8f90_source.html">MODULE_ATMOS.f90</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3
</small></address>
</body>
</html>
